import requests,base64,json

# 配置邮箱及API KEY
FOFA_EMAIL = "xxxx@gmail.com"
FOFA_KEY = "xxxxxxxxxxxxxxxxxxxx"
# Fofa Dork
qbase64 = str(base64.b64encode(input("输入FOFA规则:\n").encode()),encoding="utf8")
# 查询的记录数
size = input('输入每次查询返回记录数(≤10000条)：\n')
# api接口及相关参数
api_url='https://fofa.so/api/v1/search/all?email={}&key={}&qbase64={}&size={}'.format(FOFA_EMAIL,FOFA_KEY,qbase64,size)
resp = requests.get(api_url)
if resp.status_code == 200:
    # 处理json格式的数据
    fofa_data = json.loads(resp.text)['results']
    # 设置banner
    print("URL提取中:")
    # 判断http/https协议
    for host in fofa_data:
        if host[0].startswith("https://"):
            print(host[0])
        else:
            print("http://" + host[0])
else:
    print("获取数据失败，请检查你的网络！")    
